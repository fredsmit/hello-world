<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Custom events</title>
    <style>
    </style>
    <script type="module" src="t32.js"></script>
</head>

<body>

    <pre id="rabbit" style="font-weight: bold;">
        |\   /|
         \|_|/
         /. .\
        =\_Y_/=
         {&gt;o&lt;}
    </pre>

    <button id="btnHide">Hide rabbit</button>
    <button id="btnShow">Show rabbit</button>

</body>

<button id="menu">Menu (click me)</button>

<script>
    menu.onclick = function () {
        alert(1);

        setTimeout(() => {
            menu.dispatchEvent(new CustomEvent("menu-open", {
                bubbles: true
            }));
        });

        alert(2);
    };

    // triggers between 1 and 2 if w/o setTimeout
    document.addEventListener('menu-open', () => alert('nested'));
</script>

</html>